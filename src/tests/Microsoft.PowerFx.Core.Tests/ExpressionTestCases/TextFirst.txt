#SETUP: TextFirst

// basics

>> Hello, World
"Hello, World"

>> ="Hello, World"
"Hello, World"

>> 1+1
"1+1"

>> =1+1
2

>> =$"1+1"
"1+1"

>> =$"{1+1}"
"2"

>> ${"1+1"}
"1+1"

>> ${1+1}
"2"

>> ${$"{1+1}"}
"2"

>> ${$"${1+1}"}
"$2"

// escaping characters and lack thereof from standard string interpolation

>> {{34+6}}
"{{34+6}}"

>> "foo"
"""foo"""

>> ""foobar""
"""""foobar"""""

>> {
"{"

>> {{
"{{"

>> {{{
"{{{"

>> }
"}"

>> }}
"}}"

>> }}}
"}}}"

>> ${1+3}
"4"

>> $${1+3}
"${1+3}"

>> $$${1+3}
"$${1+3}"

>> $$$${1+3}
"$$${1+3}"

>> $
"$"

>> $$
"$$"

>> $$$
"$$$"

>> $$$$
"$$$$"

>> $}
"$}"

>> $$}
"$$}"

>> $$$}
"$$$}"

>> $$$$}
"$$$$}"

>> 'identifier name'
"'identifier name'"

>> "Quoted string"
"""Quoted string"""

>> They're here!
"They're here!"

>> They"re here!
"They""re here!"

// escaping strings starting with =

>> =
Blank()

>> ==
Errors: Error 1-2: Unexpected characters. Characters are used in the formula in an unexpected way.

>> ===
Errors: Error 1-2: Unexpected characters. Characters are used in the formula in an unexpected way.

>> ====
Errors: Error 1-2: Unexpected characters. Characters are used in the formula in an unexpected way.

>> ${"="}
"="

>> ="="
"="

// JSON should pass through without interpretation

>> [{"a":1,"b":"happy"},{"b":"days"}]
"[{""a"":1,""b"":""happy""},{""b"":""days""}]"

>> {"name":"John", "age":30, "car":null}
"{""name"":""John"", ""age"":30, ""car"":null}"

>> {"foo":{"bar":34}}
"{""foo"":{""bar"":34}}"

>> {{"bar":"asdf"},"foo":"oret"}
"{{""bar"":""asdf""},""foo"":""oret""}"

>> {{{"bar":"asdf"},"foo":"oret"},"goo":34}
"{{{""bar"":""asdf""},""foo"":""oret""},""goo"":34}"

// escaping islands

>> Hello $${1+1} World
"Hello ${1+1} World"

>> $${${3+1}}
"${4}"

// multiple islands

>> 1, ${2}, ${"3"}, ${3+1}, ${$"{3+2}"}, ${$"{$"{5+1}"}"}, ${$"7"}, 8
"1, 2, 3, 4, 5, 6, 7, 8"

>> =$"1, {2}, {"3"}, {3+1}, {$"{3+2}"}, {$"{$"{5+1}"}"}, {$"7"}, 8"
"1, 2, 3, 4, 5, 6, 7, 8"

// error messages provide correct column offsets

// without TextFirst, for comparison, note zero based
// >> UnknownFunction("arg")
// Errors: Error 0-22: 'UnknownFunction' is an unknown or unsupported function.

>> =UnknownFunction("arg")
Errors: Error 1-23: 'UnknownFunction' is an unknown or unsupported function.

>> ${UnknownFunction("arg")}
Errors: Error 2-24: 'UnknownFunction' is an unknown or unsupported function.|Error 0-25: Expressions which appear inside an interpolated string must evaluate to a Text value or to a compatible type.

>> Happy ${UnknownFunction("arg")} Days
Errors: Error 8-30: 'UnknownFunction' is an unknown or unsupported function.|Error 0-36: Expressions which appear inside an interpolated string must evaluate to a Text value or to a compatible type.

>> ="Happy " & UnknownFunction("arg") & "Days"
Errors: Error 12-34: 'UnknownFunction' is an unknown or unsupported function.

