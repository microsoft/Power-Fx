#SETUP: disable:NumberIsFloat

// decimal aware aggregate functions

>> Sum( 1.0000000000000000000000001, 2.0000000000000000000000002)
3.0000000000000000000000003

>> Sum( [1.0000000000000000000000001, 2.0000000000000000000000002], Value )
3.0000000000000000000000003

>> Average( 1.0000000000000000000000001, 2.0000000000000000000000002 )
1.50000000000000000000000015

>> Average( [1.0000000000000000000000001, 2.0000000000000000000000002], Value )
1.50000000000000000000000015

>> Min( 1.0000000000000000000000001, 2.0000000000000000000000002 )
1.0000000000000000000000001

>> Min( [1.0000000000000000000000001, 2.0000000000000000000000002], Value )
1.0000000000000000000000001

>> Max( 1.0000000000000000000000001, 2.0000000000000000000000002 )
2.0000000000000000000000002

>> Max( [1.0000000000000000000000001, 2.0000000000000000000000002], Value )
2.0000000000000000000000002

// decimal aware aggregate functions with mixed inputs -> float

>> Sum( 1.0000000000000000000000001, 2.0000000000000000000000002, Float(3))
6.0000000000000000000000003

>> Sum( [1.0000000000000000000000001, 2.0000000000000000000000002, Float(3)], Value )
6.0000000000000000000000003

>> Average( 1.0000000000000000000000001, 2.0000000000000000000000002, Float(3) )
2.0000000000000000000000001

>> Average( [1.0000000000000000000000001, 2.0000000000000000000000002, Float(3)], Value )
2.0000000000000000000000001

>> Min( 1.0000000000000000000000001, 2.0000000000000000000000002, Float(3) )
1.0000000000000000000000001

>> Min( [1.0000000000000000000000001, 2.0000000000000000000000002, Float(3)], Value )
1.0000000000000000000000001

>> Max( 1.0000000000000000000000001, 2.0000000000000000000000002, Float(-3) )
2.0000000000000000000000002

>> Max( [1.0000000000000000000000001, 2.0000000000000000000000002, Float(-3)], Value )
2.0000000000000000000000002

// non-decimal aware aggregate functions

>> VarP( 1.0000000000000000000000001, 2.0000000000000000000000002)
0.25

>> VarP( [1.0000000000000000000000001, 2.0000000000000000000000002], Value )
0.25

>> StdevP( 1.0000000000000000000000001, 2.0000000000000000000000002)
0.5

>> StdevP( [1.0000000000000000000000001, 2.0000000000000000000000002], Value )
0.5

>> VarP( 1.0000000000000000000000001, 2.0000000000000000000000002, Float(3) )
0.6666666666666666

>> VarP( [1.0000000000000000000000001, 2.0000000000000000000000002, Float(3)], Value )
0.6666666666666666

>> StdevP( 1.0000000000000000000000001, 2.0000000000000000000000002, Float(3) )
0.816496580927726

>> StdevP( [1.0000000000000000000000001, 2.0000000000000000000000002, Float(3)], Value )
0.816496580927726

// decimal aware numeric functions, stays on decimal

>> Int( 1000000000000000000000001.1 )
1000000000000000000000001

>> Int( -1000000000000000000000001.1 )
-1000000000000000000000002

>> Int( [1000000000000000000000001.1, 2000000000000000000000002.2] )
Table({Value:1000000000000000000000001},{Value:2000000000000000000000002})

>> Trunc( 1000000000000000000000001.1 )
1000000000000000000000001

>> Trunc( [1000000000000000000000001.1, 2000000000000000000000002.2] )
Table({Value:1000000000000000000000001},{Value:2000000000000000000000002})

>> Round( 1000000000000000000000001.1, 2 )
1000000000000000000000001.1

>> Round( [1000000000000000000000001.1, 2000000000000000000000002.2], 2 )
Table({Value:1000000000000000000000001.1},{Value:2000000000000000000000002.2})

>> Round( 1000000000000000000000001.1, Float(2) )
1000000000000000000000001.1

>> Round( [1000000000000000000000001.1, 2000000000000000000000002.2], Float(2) )
Table({Value:1000000000000000000000001.1},{Value:2000000000000000000000002.2})

>> RoundUp( 1000000000000000000000001.1, 2 )
1000000000000000000000001.1

>> RoundUp( [1000000000000000000000001.1, 2000000000000000000000002.2], 2 )
Table({Value:1000000000000000000000001.1},{Value:2000000000000000000000002.2})

>> RoundUp( 1000000000000000000000001.1, Float(2) )
1000000000000000000000001.1

>> RoundUp( [1000000000000000000000001.1, 2000000000000000000000002.2], Float(2) )
Table({Value:1000000000000000000000001.1},{Value:2000000000000000000000002.2})

>> RoundDown( 1000000000000000000000001.1, 2 )
1000000000000000000000001.1

>> RoundDown( [1000000000000000000000001.1, 2000000000000000000000002.2], 2 )
Table({Value:1000000000000000000000001.1},{Value:2000000000000000000000002.2})

>> RoundDown( 1000000000000000000000001.1, Float(2) )
1000000000000000000000001.1

>> RoundDown( [1000000000000000000000001.1, 2000000000000000000000002.2], Float(2) )
Table({Value:1000000000000000000000001.1},{Value:2000000000000000000000002.2})

>> Abs( 10000000000000000000000001 )
10000000000000000000000001

>> Abs( -10000000000000000000000001 )
10000000000000000000000001

>> Abs( [10000000000000000000000001, 20000000000000000000000002, -10000000000000000000000001, -20000000000000000000000002])
Table({Value:10000000000000000000000001},{Value:20000000000000000000000002},{Value:10000000000000000000000001},{Value:20000000000000000000000002})

>> Abs( [10000000000000000000000001, 20000000000000000000000002, -10000000000000000000000001, -20000000000000000000000002, Float(1)])
Table({Value:10000000000000000000000001},{Value:20000000000000000000000002},{Value:10000000000000000000000001},{Value:20000000000000000000000002},{Value:1})

// decimal aware functions with mixed inputs

>> Int( [1000000000000000000000001.1, 2000000000000000000000002.2, Float(100000.12)] )
Table({Value:1000000000000000000000001},{Value:2000000000000000000000002},{Value:100000})

>> Trunc( [1000000000000000000000001.1, 2000000000000000000000002.2, Float(100000.12)] )
Table({Value:1000000000000000000000001},{Value:2000000000000000000000002},{Value:100000})

>> Round( [1000000000000000000000001.1, 2000000000000000000000002.2, Float(300000.1234)], 2 )
Table({Value:1000000000000000000000001.1},{Value:2000000000000000000000002.2},{Value:300000.12})

>> RoundUp( [1000000000000000000000001.1, 2000000000000000000000002.2, Float(300000.1234)], 2 )
Table({Value:1000000000000000000000001.1},{Value:2000000000000000000000002.2},{Value:300000.13})

>> RoundDown( [1000000000000000000000001.1, 2000000000000000000000002.2, Float(30000.1234)], 2 )
Table({Value:1000000000000000000000001.1},{Value:2000000000000000000000002.2},{Value:30000.12})

// these rounding tests are returning the correct results, due to the conversion between decimal and float

>> Int( [Float(100000.12), 1000000000000000000000001.1, 2000000000000000000000002.2] )
Table({Value:100000},{Value:1000000000000000100000000},{Value:2000000000000000200000000})

>> Trunc( [Float(100000.12), 1000000000000000000000001.1, 2000000000000000000000002.2] )
Table({Value:100000},{Value:1000000000000000100000000},{Value:2000000000000000200000000})

>> Round( [Float(300000.1234), 1000000000000000000000001.1, 2000000000000000000000002.2], 2 )
Table({Value:300000.12},{Value:1000000000000000100000000},{Value:2000000000000000200000000})

>> RoundUp( [Float(300000.1234), 1000000000000000000000001.1, 2000000000000000000000002.2], 2 )
Table({Value:300000.13},{Value:1000000000000000100000000},{Value:2000000000000000200000000})

>> RoundDown( [Float(30000.1234), 1000000000000000000000001.1, 2000000000000000000000002.2], 2 )
Table({Value:30000.12},{Value:1000000000000000100000000},{Value:2000000000000000200000000})

// non-decimal aware numeric functions

// exact square of 1234567899876 is 1524157899404237160815376
// taking dquare root of 1524157899404230000000000 should result in a difference between float and decimal
>> Sqrt( 1524157899404230000000000 )
1234567899876

>> Sqrt( Float(1524157899404230000000000) )
1234567899876

>> Sqrt( 4.000000000000000004 )              // outside of float range, will round to 4
2

>> Sqrt( 4.0000000004 )                      // within float range
2.0000000001

>> Log( 100, 10 )
2

>> Log( 10000000000000050000000, 10 )         // input will be rounded with float conversion
22

>> Log( 10000000000000050000000, Float(10) )
22

>> Log( 10000000000000000000000, 10 )         // above tests should match these answers
22

>> Log( 10000000000000000000000, Float(10) )  
22

>> Log( Float("1e100"), 10 )
100

>> Ln( 2.71828182845904523536028747135266249775724709369995 )
1

>> Ln( 100000000 )
18.420680743952367

>> Exp( 18.420680743952367 )
100000000.00000007

>> Pi()
3.141592653589793

>> Cos( 0 )
1

>> Cos( [0] )
Table({Value:1})

>> Cos( Pi() )
-1

>> Cos( [Pi()] )
Table({Value:-1})

>> Sin( 0 )
0

>> Sin( [0] )
Table({Value:0})

>> Sin( Pi()/2 )
1

>> Cot( 0 )
Error({Kind:ErrorKind.Div0})

>> Cot( [0] )
Table({Value:Error({Kind:ErrorKind.Div0})})

>> Cot( 3.14159265358979323846264338327950288419716939937510 )
-8165619676597685

>> Cot( [3.14159265358979323846264338327950288419716939937510] )
Table({Value:-8165619676597685})

>> Cot( Pi()/4 )
1

>> Round( Cot( [Pi()/4] ), 10 )
Table({Value:1})

>> Tan( 0 )
0

>> Tan( [0] )
Table({Value:0})

>> Tan( Pi()/4 )
1

>> Round( Tan( [Pi()/4] ), 10 )
Table({Value:1})

>> Acos( 0 )
1.5707963267948966

>> Acos( [0] )
Table({Value:1.5707963267948966})

>> Acos( 1 )
0

>> Acos( [1] )
Table({Value:0})

>> Acot( 0 )
1.5707963267948966

>> Acot( [0] )
Table({Value:1.5707963267948966})

>> Acot( 1 )
0.7853981633974483

>> Acot( [1] )
Table({Value:0.7853981633974483})

>> Asin( 0 )
0

>> Asin( [0] )
Table({Value:0})

>> Asin( 1 )
1.5707963267948966

>> Asin( [1] )
Table({Value:1.5707963267948966})

>> Atan( 0 )
0

>> Atan( [0] )
Table({Value:0})

>> Atan( 1 )
0.7853981633974483

>> Atan( [1] )
Table({Value:0.7853981633974483})

>> 4 * Atan(1) - Pi()
0

>> Atan( [4 * Atan(1) - Pi()] )
Table({Value:0})

>> Atan2( 0, 0 )
Error({Kind:ErrorKind.Div0})

>> Atan2( 1, 1 )
0.7853981633974483

>> Degrees( Pi() )
180

>> Degrees( 3.14159265358979323846264338327950288419716939937510 )
180

>> Radians( 0 )
0

>> Radians( 180 )
3.141592653589793

>> Power( 2.0000000000000000000000002, 2.0000000000000000000000002)
4

>> 2.0000000000000000000000002 ^ 2.0000000000000000000000002
4

// Decimal and Float functions

>> Value( 1e100 )
Errors: Error 7-12: Numeric value is too large.|Error 0-14: The function 'Value' has some invalid arguments.|Error 7-12: Expected text or number. We expect text or a number at this point in the formula.

>> Decimal( 1e100 )
Errors: Error 9-14: Numeric value is too large.|Error 0-16: The function 'Decimal' has some invalid arguments.|Error 9-14: Expected text or number. We expect text or a number at this point in the formula.

>> Float( 1e100 )
Errors: Error 7-12: Numeric value is too large.|Error 0-14: The function 'Float' has some invalid arguments.|Error 7-12: Expected text or number. We expect text or a number at this point in the formula.

>> Value( "1e100" )
Error({Kind:ErrorKind.InvalidArgument})

>> Decimal( "1e100" )
Error({Kind:ErrorKind.InvalidArgument})

>> Value( true )
1

>> Decimal( true )
1

>> Float( true )
1

>> Decimal( "12,00000000000000000000003", "Fr-fr" )
12.00000000000000000000003

>> Float( "12,00000000000000000000003", "Fr-fr" )
12

>> Value( "12,00000000000000000000003", "Fr-fr" )
12.00000000000000000000003

>> Decimal( ParseJSON("""12,00000000000000000000003"""), "Fr-fr" )
12.00000000000000000000003

>> Float( ParseJSON("""12,00000000000000000000003"""), "Fr-fr" )
12

>> Value( ParseJSON("""12,00000000000000000000003"""), "Fr-fr" )
12.00000000000000000000003

// ParseJSON

>> Decimal( ParseJSON("12.00000000000000000000003") )
12.00000000000000000000003

>> Float( ParseJSON("12.00000000000000000000003") )
12

>> Value( ParseJSON("12.00000000000000000000003") )
12.00000000000000000000003

>> Decimal( Index( ParseJSON("[1e300,12.00000000000000000000003]"), 2 ) )
12.00000000000000000000003

>> Float( Index( ParseJSON("[1e300,12.00000000000000000000003]"), 2 ) )
12

>> Value( Index( ParseJSON("[1e300,12.00000000000000000000003]"), 2 ) )
12.00000000000000000000003

>> Decimal( ParseJSON("{""a"":12.00000000000000000000003}").a )
12.00000000000000000000003

>> Float( ParseJSON("{""a"":12.00000000000000000000003}").a )
12

>> Value( ParseJSON("{""a"":12.00000000000000000000003}").a )
12.00000000000000000000003

>> Round( 79228162514264337593543950335, -2 )
79228162514264337593543950300

>> Round( 79228162514264337593543950335, 2 )
79228162514264337593543950335

>> Round( 79228162514264337593543950335, 100 )
79228162514264337593543950335

>> Round( 79228162514264337593543950335, -100 )
0

// result 79228162514264337593543950400 overflows
>> RoundUp( 79228162514264337593543950335, -2 )
Error({Kind:ErrorKind.Numeric})

>> RoundUp( 79228162514264337593543950335, 2 )
79228162514264337593543950335

>> RoundUp( 79228162514264337593543950335, 100 )
79228162514264337593543950335

>> RoundUp( 79228162514264337593543950335, -100 )
0

>> RoundDown( 79228162514264337593543950335, -2 )
79228162514264337593543950300

>> RoundDown( 79228162514264337593543950335, 2 )
79228162514264337593543950335

>> RoundDown( 79228162514264337593543950335, 100 )
79228162514264337593543950335

>> RoundDown( 79228162514264337593543950335, -100 )
0

